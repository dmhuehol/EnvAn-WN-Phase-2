%%wetbulb
%Function to calculate wetbulb temperature
%Written by Daniel Hueholt
%Last updated 11/21/17

function [wetbulbTemp] = wetbulb(P,Td,T)
if Td<100
    Td = Td+273.15; %Kelvin conversion
end
if T<100
    T = T+273.15; %Kelvin
end

epsilon = 0.622;
Lv = 2.5*10^6; %J/kg
Cp = 1005; %J/kg
psychro = (Cp.*P)./(Cp.*P);
syms Tw
%T, P, e
eAct = 611*exp(19.83-5417./Td); %Actual vapor pressure is calculated from dewpoint


wetbulbTemp = vpasolve(eAct == 611*exp(19.83-5417./Tw)-psychro.*(T-Tw));
end